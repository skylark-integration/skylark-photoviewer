{"version":3,"sources":["skylark-photoviewer.js"],"names":["define","$","draggable","resizable","movable","keyboard","title","modalWidth","modalHeight","fixedContent","fixedModalSize","initMaximized","gapThreshold","ratioThreshold","minRatio","maxRatio","headerToolbar","footerToolbar","icons","minimize","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight","i18n","multiInstances","initAnimation","fixedModalPos","zIndex","dragHandle","callbacks","beforeOpen","noop","opened","beforeClose","closed","beforeChange","changed","index","progressiveLoading","appendTo","customButtons","langx","browser","noder","geom","images","document","window","throttle","debounce","preloadImage","src","success","error","preload","then","data","imgs","requestFullscreen","exitFullscreen","getImageNameFromUrl","url","replace","hasScrollbar","getScrollbarWidth","scrollbarWidth","setGrabCursor","imageData","stageData","stage","isRotated","imageWidth","h","w","imageHeight","addClass","removeClass","supportTouch","support","tocuh","utilities","$W","$D","TOUCH_START_EVENT","TOUCH_MOVE_EVENT","TOUCH_END_EVENT","NS","CLICK_EVENT","RESIZE_EVENT","KEYDOWN_EVENT","WHEEL_EVENT","CLASS_NS","EVENT_NS","PUBLIC_VARS","isMoving","isResizing","eventer","plugins","Movable","Resizable","Constants","Utilities","Window","Plugin","inherit","klassName","pluginName","options","selectors","headerPane","contentPane","footerPane","titlebar","buttons","minWidth","minHeight","_construct","elm","prototype","call","this","isOpened","isMaximized","$photoviewer","_elm","_velm","elmx","_movable","handle","starting","e","dragCancel","elemCancel","target","closest","length","_resizable","border","directions","top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight","classes","all","constraints","started","moving","stopped","$close","$maximize","$minimize","$fullscreen","off","on","_keydown","resized","trigger","remove","css","overflow","padding-right","get","focus","initModalLeft","width","scrollLeft","initModalTop","height","scrollTop","modalData","offset","keyCode","which","charCode","ctrlKey","metaKey","altKey","Imager","$stage","$image","find","_handleWheel","hasClass","stageWidth","stageHeight","minX","minY","maxX","maxY","stop","getImageScaleToStage","scale","Math","min","img","setImageSize","ceil","extend","initWidth","initHeight","initLeft","initTop","imageLoaded","fadeIn","loadImage","imgSrc","fn","err","removeAttr","attr","rotateAngle","append","hide","originalWidth","originalHeight","preventDefault","delta","deltaY","wheelDelta","detail","ratio","pointer","x","clientX","y","clientY","zoom","origin","zoomTo","imgData","newWidth","newHeight","newLeft","newTop","Î´","imgNewWidth","imgNewHeight","offsetX","offsetY","abs","round","rotate","angle","rotateTo","transform","resize","shortcut","handled","DEFAULTS","PhotoViewer","[object Object]","items","el","isArray","$el","isDoResize","init","opts","groupData","groupIndex","open","toolbar","btns","btnsHTML","each","item","btnClass","indexOf","text","photoviewerHTML","_createBtns","_createTitle","_createTemplate","$title","$zoomIn","$zoomOut","$actualSize","$rotateLeft","$rotateRight","$prev","$next","eq","_window","_imager","_addEvents","_addCustomButtonEvents","_triggerHook","build","setModalPos","modal","winWidth","winHeight","stageCSS","borderLeft","borderRight","borderTop","borderBottom","parseFloat","max","modalCSSObj","animate","setModalSize","setImageTitle","html","step","jumpTo","jump","btnKey","click","apply","main"],"mappings":"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","file":"../skylark-photoviewer.js","sourcesContent":["define('skylark-photoviewer/domq',['skylark-jquery'], function ($) {\n    'use strict';\n\n    return $;\n});\ndefine('skylark-photoviewer/defaults',[\n    './domq'\n], function ($) {\n    'use strict';\n    return {\n        draggable: true,\n        resizable: true,\n        movable: true,\n        keyboard: true,\n        title: true,\n        modalWidth: 320,\n        modalHeight: 320,\n        fixedContent: true,\n        fixedModalSize: false,\n        initMaximized: false,\n        gapThreshold: 0.02,\n        ratioThreshold: 0.1,\n        minRatio: 0.05,\n        maxRatio: 16,\n        headerToolbar: [\n            'maximize',\n            'close'\n        ],\n        footerToolbar: [\n            'zoomIn',\n            'zoomOut',\n            'prev',\n            'fullscreen',\n            'next',\n            'actualSize',\n            'rotateRight'\n        ],\n        icons: {\n            minimize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M20,14H4V10H20\"></path>\n      </svg>`,\n            maximize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M4,4H20V20H4V4M6,8V18H18V8H6Z\"></path>\n      </svg>`,\n            close: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12\n        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z\"></path>\n      </svg>`,\n            zoomIn: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\n        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5\n        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5\n        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z\"></path>\n      </svg>`,\n            zoomOut: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5\n        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16\n        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14\n        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z\"></path>\n      </svg>`,\n            prev: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z\"></path>\n      </svg>`,\n            next: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M16,18H18V6H16M6,18L14.5,12L6,6V18Z\"></path>\n      </svg>`,\n            fullscreen: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3\n        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z\"></path>\n      </svg>`,\n            actualSize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09\n        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19\n        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\n        L13.09,9.5Z\"></path>\n      </svg>`,\n            rotateLeft: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12\n        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07\n        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32\n        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13\n        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z\"></path>\n      </svg>`,\n            rotateRight: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\n        <path fill=\"currentColor\" d=\"M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91\n        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31\n        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11\n        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12\n        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10\n        L15.55,5.55Z\"></path>\n      </svg>`\n        },\n        i18n: {\n            minimize: 'minimize',\n            maximize: 'maximize',\n            close: 'close',\n            zoomIn: 'zoom-in (+)',\n            zoomOut: 'zoom-out (-)',\n            prev: 'prev (\\u2190)',\n            next: 'next (\\u2192)',\n            fullscreen: 'fullscreen',\n            actualSize: 'actual-size (Ctrl+Alt+0)',\n            rotateLeft: 'rotate-left (Ctrl+,)',\n            rotateRight: 'rotate-right (Ctrl+.)'\n        },\n        multiInstances: true,\n        initAnimation: true,\n        fixedModalPos: false,\n        zIndex: 1090,\n        dragHandle: false,\n        callbacks: {\n            beforeOpen: $.noop,\n            opened: $.noop,\n            beforeClose: $.noop,\n            closed: $.noop,\n            beforeChange: $.noop,\n            changed: $.noop\n        },\n        index: 0,\n        progressiveLoading: true,\n        appendTo: 'body',\n        customButtons: {}\n    };\n});\ndefine('skylark-photoviewer/utilities',[\n    \"skylark-langx\",\n    \"skylark-domx-browser\",\n    \"skylark-domx-noder\",\n    \"skylark-domx-geom\",\n    \"skylark-domx-images\"\n],function (langx,browser,noder,geom,images) {\n    'use strict';\n    const document = window.document;\n\n    /*\n    function throttle(fn, delay) {\n        let timer = null;\n        return function () {\n            const context = this;\n            const args = arguments;\n            clearTimeout(timer);\n            timer = setTimeout(function () {\n                fn.apply(context, args);\n            }, delay);\n        };\n    }\n    function preloadImage(src, success, error) {\n        const img = new Image();\n        img.onload = function () {\n            success(img);\n        };\n        img.onerror = function () {\n            error(img);\n        };\n        img.src = src;\n    }\n    function requestFullscreen(element) {\n        if (element.requestFullscreen) {\n            element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n            element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n            element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n            element.msRequestFullscreen();\n        }\n    }\n    function exitFullscreen() {\n        if (document.exitFullscreen) {\n            document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n            document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n            document.webkitExitFullscreen();\n        }\n    }\n\n\n    function getScrollbarWidth() {\n        const scrollDiv = document.createElement('div');\n        scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';\n        document.body.appendChild(scrollDiv);\n        const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n        document.body.removeChild(scrollDiv);\n        return scrollbarWidth;\n    }\n\n    function hasScrollbar() {\n        return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);\n    }\n\n\n    function supportTouch() {\n        return !!('ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\n    }\n\n    */\n \n\n     function setGrabCursor(imageData, stageData, stage, isRotated) {\n        const imageWidth = !isRotated ? imageData.w : imageData.h;\n        const imageHeight = !isRotated ? imageData.h : imageData.w;\n        if (imageHeight > stageData.h || imageWidth > stageData.w) {\n            stage.addClass('is-grab');\n        }\n        if (imageHeight <= stageData.h && imageWidth <= stageData.w) {\n            stage.removeClass('is-grab');\n        }\n    }\n\n    function getImageNameFromUrl(url) {\n        const reg = /^.*?\\/*([^/?]*)\\.[a-z]+(\\?.+|$)/gi;\n        const txt = url.replace(reg, '$1');\n        return txt;\n    }\n\n    return {\n        document: document,\n        throttle: langx.debounce,\n        preloadImage: function preloadImage(src, success, error) {\n            images.preload(src).then(function(data){\n                success(data.imgs[0]);\n            },error);\n        },\n        requestFullscreen: noder.fullscreen,\n        exitFullscreen: noder.fullscreen,\n        getImageNameFromUrl: getImageNameFromUrl,\n        hasScrollbar: geom.hasScrollbar,\n        getScrollbarWidth: geom.scrollbarWidth,\n        setGrabCursor: setGrabCursor,\n        supportTouch: function() {\n            return browser.support.tocuh;\n        }\n    }\n});\ndefine('skylark-photoviewer/constants',[\n    './domq',\n    './utilities'\n], function ($, utilities) {\n    'use strict';\n    const $W = $(window);\n    const $D = $(utilities.document);\n    const CLICK_EVENT = 'click';\n    const RESIZE_EVENT = 'resize';\n    const KEYDOWN_EVENT = 'keydown';\n    const WHEEL_EVENT = 'wheel mousewheel DOMMouseScroll';\n    const TOUCH_START_EVENT = utilities.supportTouch() ? 'touchstart' : 'mousedown';\n    const TOUCH_MOVE_EVENT = utilities.supportTouch() ? 'touchmove' : 'mousemove';\n    const TOUCH_END_EVENT = utilities.supportTouch() ? 'touchend' : 'mouseup';\n    const NS = 'photoviewer';\n    const CLASS_NS = '.' + NS;\n    const EVENT_NS = '.' + NS;\n    const PUBLIC_VARS = {\n        isMoving: false,\n        isResizing: false,\n        zIndex: 0\n    };\n    return {\n        $W: $W,\n        $D: $D,\n        CLICK_EVENT: CLICK_EVENT,\n        RESIZE_EVENT: RESIZE_EVENT,\n        KEYDOWN_EVENT: KEYDOWN_EVENT,\n        WHEEL_EVENT: WHEEL_EVENT,\n        TOUCH_START_EVENT: TOUCH_START_EVENT,\n        TOUCH_MOVE_EVENT: TOUCH_MOVE_EVENT,\n        TOUCH_END_EVENT: TOUCH_END_EVENT,\n        NS: NS,\n        CLASS_NS: CLASS_NS,\n        EVENT_NS: EVENT_NS,\n        PUBLIC_VARS: PUBLIC_VARS\n    };\n});\ndefine('skylark-photoviewer/window',[\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-plugins-base\",\r\n    'skylark-jquery',\r\n    \"skylark-domx-plugins-interact/movable\",\r\n    \"skylark-domx-plugins-interact/resizable\",\r\n    './constants',\r\n    './utilities'\r\n\r\n], function (eventer,plugins,$,  Movable, Resizable, Constants, Utilities,) {\r\n    'use strict';\r\n\r\n    var Window = plugins.Plugin.inherit({\r\n        klassName : \"Window\",\r\n\r\n        pluginName : \"lark.domx.window\",\r\n\r\n        options : {\r\n            selectors : {\r\n                headerPane  : \"\",\r\n                contentPane : \"\",\r\n                footerPane  : \"\",\r\n                titlebar : \"\",\r\n                buttons : {\r\n                    \"fullscreen\" : \".photoviewer-button-fullscreen\",\r\n                    \"maximize\" : \".photoviewer-button-maximize\",\r\n                    \"minimize\" : \".photoviewer-button-minimize\",     \r\n                    \"close\" : \".photoviewer-button-close\"\r\n                }\r\n            },\r\n\r\n            fixedContent: true,\r\n            initMaximized: false,\r\n\r\n\r\n\r\n\r\n            movable : {\r\n                dragHandle: false\r\n            },\r\n            resizable : {\r\n                minWidth: 320,\r\n                minHeight: 320,\r\n            }\r\n        },\r\n\r\n        _construct : function(elm,options) {\r\n            plugins.Plugin.prototype._construct.call(this,elm,options);\r\n            this.isOpened = false;\r\n            this.isMaximized = false;\r\n\r\n            this.$photoviewer = $(this._elm);\r\n\r\n            this._velm = this.elmx();\r\n\r\n            if (this.options.movable) {\r\n                this._movable = new Movable(elm,{\r\n                    handle : this.options.movable.dragHandle,\r\n                    starting : (e) => {\r\n                        const   dragCancel = Constants.CLASS_NS + '-button', \r\n                                elemCancel = $(e.target).closest(dragCancel);\r\n                        if (elemCancel.length) {\r\n                            return false;\r\n                        }\r\n                        if (Constants.PUBLIC_VARS['isResizing'] || this.isMaximized) {\r\n                            return false;\r\n                        }\r\n\r\n                        return true;\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            if (this.options.resizable) {\r\n\r\n                this._resizable = new Resizable(elm,{\r\n                    handle : {\r\n                        border : {\r\n                            directions : {\r\n                                top: true, //n\r\n                                left: true, //w\r\n                                right: true, //e\r\n                                bottom: true, //s\r\n                                topLeft : true, // nw\r\n                                topRight : true, // ne\r\n                                bottomLeft : true, // sw\r\n                                bottomRight : true // se                         \r\n                            },\r\n                            classes : {\r\n                                all : `${ Constants.NS }-resizable-handle`,\r\n                                top : `${ Constants.NS }-resizable-handle-n`,\r\n                                left: `${ Constants.NS }-resizable-handle-w`,\r\n                                right: `${ Constants.NS }-resizable-handle-e`,\r\n                                bottom: `${ Constants.NS }-resizable-handle-s`, \r\n                                topLeft : `${ Constants.NS }-resizable-handle-nw`, \r\n                                topRight : `${ Constants.NS }-resizable-handle-ne`,\r\n                                bottomLeft : `${ Constants.NS }-resizable-handle-sw`,             \r\n                                bottomRight : `${ Constants.NS }-resizable-handle-se`                         \r\n                            }                        \r\n                        }\r\n                    },\r\n                    constraints : {\r\n                        minWidth : this.options.resizable.minWidth,\r\n                        minHeight : this.options.resizable.minHeight\r\n                    },\r\n                    started : function(){\r\n                        Constants.PUBLIC_VARS['isResizing'] = true;\r\n                    },\r\n                    moving : function(e) {\r\n                        /*\r\n                        const imageWidth = $(image).width();\r\n                        const imageHeight = $(image).height();\r\n                        const stageWidth = $(stage).width();\r\n                        const stageHeight = $(stage).height();\r\n                        const left = (stageWidth - imageWidth) /2;\r\n                        const top = (stageHeight- imageHeight) /2;\r\n                        $(image).css({\r\n                            left,\r\n                            top\r\n                        });\r\n                        */\r\n                    },\r\n                    stopped :function () {\r\n                        Constants.PUBLIC_VARS['isResizing'] = false;\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            this.$close = this._velm.$(this.options.selectors.buttons.close);\r\n            this.$maximize = this._velm.$(this.options.selectors.buttons.maximize);\r\n            this.$minimize = this._velm.$(this.options.selectors.buttons.minimize);\r\n            this.$fullscreen = this._velm.$(this.options.selectors.buttons.fullscreen);\r\n\r\n\r\n            this.$close.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\r\n                this.close();\r\n            });\r\n            this.$fullscreen.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.fullscreen();\r\n            });\r\n            this.$maximize.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.maximize();\r\n            });\r\n            this.$photoviewer.off(Constants.KEYDOWN_EVENT + Constants.EVENT_NS).on(Constants.KEYDOWN_EVENT + Constants.EVENT_NS, e => {\r\n                this._keydown(e);\r\n            });\r\n            Constants.$W.on(Constants.RESIZE_EVENT + Constants.EVENT_NS, ()=>{\r\n                            eventer.resized(this._elm);\r\n                        });\r\n        },\r\n        close: function() {\r\n            this.trigger('closing', this);\r\n            this.$photoviewer.remove();\r\n            this.isOpened = false;\r\n            this.isMaximized = false;\r\n\r\n            if (!$(Constants.CLASS_NS + '-modal').length) {\r\n                if (this.options.fixedContent) {\r\n                    $('html').css({\r\n                        overflow: '',\r\n                        'padding-right': ''\r\n                    });\r\n                }\r\n                if (this.options.multiInstances) {\r\n                    Constants.PUBLIC_VARS['zIndex'] = this.options.zIndex;\r\n                }\r\n                Constants.$W.off(Constants.RESIZE_EVENT + Constants.EVENT_NS);\r\n            }\r\n            this.trigger('closed', this);\r\n        },\r\n\r\n        maximize: function() {\r\n            this.$photoviewer.get(0).focus();\r\n            if (!this.isMaximized) {\r\n                this.modalData = {\r\n                    width: this.$photoviewer.width(),\r\n                    height: this.$photoviewer.height(),\r\n                    left: this.$photoviewer.offset().left,\r\n                    top: this.$photoviewer.offset().top\r\n                };\r\n                this.$photoviewer.addClass(Constants.NS + '-maximize');\r\n                this.$photoviewer.css({\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    left: 0,\r\n                    top: 0\r\n                });\r\n                this.isMaximized = true;\r\n            } else {\r\n                this.$photoviewer.removeClass(Constants.NS + '-maximize');\r\n                const initModalLeft = (Constants.$W.width() - this.options.modalWidth) / 2 + Constants.$D.scrollLeft();\r\n                const initModalTop = (Constants.$W.height() - this.options.modalHeight) / 2 + Constants.$D.scrollTop();\r\n                this.$photoviewer.css({\r\n                    width: this.modalData.width ? this.modalData.width : this.options.modalWidth,\r\n                    height: this.modalData.height ? this.modalData.height : this.options.modalHeight,\r\n                    left: this.modalData.left ? this.modalData.left : initModalLeft,\r\n                    top: this.modalData.top ? this.modalData.top : initModalTop\r\n                });\r\n                this.isMaximized = false;\r\n            }\r\n\r\n            eventer.resized(this._elm);\r\n        },\r\n        fullscreen: function() {\r\n            this.$photoviewer.get(0).focus();\r\n            Utilities.requestFullscreen(this.$photoviewer[0]);\r\n        },\r\n        _keydown: function(e) {\r\n            if (!this.options.keyboard) {\r\n                return false;\r\n            }\r\n            const keyCode = e.keyCode || e.which || e.charCode;\r\n            const ctrlKey = e.ctrlKey || e.metaKey;\r\n            const altKey = e.altKey || e.metaKey;\r\n            switch (keyCode) {\r\n\r\n                // Q\r\n                case 81:\r\n                    this.close();\r\n                    break;\r\n                default:\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n\r\n    return Window;\r\n});\ndefine('skylark-photoviewer/picture_viewer',[\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-plugins-base\",\r\n    \"skylark-domx-plugins-interact/movable\",\r\n    'skylark-jquery',\r\n    './constants',\r\n    './utilities'\r\n\r\n], function (eventer,plugins,Movable,$,  Constants, Utilities) {\r\n    'use strict';\r\n\r\n    var Imager = plugins.Plugin.inherit({\r\n        klassName : \"Imager\",\r\n\r\n        pluginName : \"lark.domx.imager\",\r\n\r\n        options : {\r\n            ratioThreshold: 0.1,\r\n            minRatio: 0.05,\r\n            maxRatio: 16,\r\n            movable : true\r\n        },\r\n\r\n        _construct : function(elm,options) {\r\n            plugins.Plugin.prototype._construct.call(this,elm,options);\r\n\r\n            this.$stage = this.$();\r\n            this.$image = this.$stage.find(\"img\");\r\n            \r\n\r\n            this.$stage.off(Constants.WHEEL_EVENT + Constants.EVENT_NS).on(Constants.WHEEL_EVENT + Constants.EVENT_NS, e => {\r\n                this._handleWheel(e);\r\n            });\r\n\r\n            if (this.options.movable) {\r\n                this._movable = new Movable(this.$image[0],{\r\n                    starting : (e) => {\r\n                        if (this.$stage.hasClass('is-grab')) {\r\n\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                        const imageWidth = this.$image.width();\r\n                        const imageHeight = this.$image.height();\r\n                        const stageWidth = this.$stage.width();\r\n                        const stageHeight = this.$stage.height();\r\n                        let minX,minY,maxX,maxY;\r\n\r\n                        if (stageWidth>=imageWidth) {\r\n                            minX=maxX=(stageWidth-imageWidth) / 2;\r\n                        } else {\r\n                            minX = stageWidth - imageWidth;\r\n                            maxX = 0;\r\n                        }\r\n\r\n                        if (stageHeight>=imageHeight) {\r\n                            minY=maxY=(stageHeight-imageHeight) / 2;\r\n                        } else {\r\n                            minY = stageHeight - imageHeight;\r\n                            maxY = 0;\r\n                        }\r\n\r\n                        return {\r\n                            constraints : {\r\n                                minX,\r\n                                maxX,\r\n                                minY,\r\n                                maxY\r\n                            }\r\n                        };\r\n                    },\r\n                    started : function(e) {\r\n                        eventer.stop(e);\r\n                    }\r\n                });\r\n            }\r\n\r\n        }, \r\n\r\n        getImageScaleToStage : function(stageWidth, stageHeight) {\r\n            let scale = 1;\r\n            if (!this.isRotated) {\r\n                scale = Math.min(stageWidth / this.img.width, stageHeight / this.img.height, 1);\r\n            } else {\r\n                scale = Math.min(stageWidth / this.img.height, stageHeight / this.img.width, 1);\r\n            }\r\n            return scale;\r\n        },\r\n\r\n        setImageSize: function(img) {\r\n            const stageData = {\r\n                w: this.$stage.width(),\r\n                h: this.$stage.height()\r\n            };\r\n            const scale = this.getImageScaleToStage(stageData.w, stageData.h);\r\n            this.$image.css({\r\n                width: Math.ceil(img.width * scale) + 'px',\r\n                height: Math.ceil(img.height * scale) + 'px',\r\n                left: (stageData.w - Math.ceil(img.width * scale)) / 2 + 'px',\r\n                top: (stageData.h - Math.ceil(img.height * scale)) / 2 + 'px'\r\n            });\r\n            $.extend(this.imageData, {\r\n                initWidth: img.width * scale,\r\n                initHeight: img.height * scale,\r\n                initLeft: (stageData.w - img.width * scale) / 2,\r\n                initTop: (stageData.h - img.height * scale) / 2,\r\n                width: img.width * scale,\r\n                height: img.height * scale,\r\n                left: (stageData.w - img.width * scale) / 2,\r\n                top: (stageData.h - img.height * scale) / 2\r\n            });\r\n            Utilities.setGrabCursor({\r\n                w: this.$image.width(),\r\n                h: this.$image.height()\r\n            }, {\r\n                w: this.$stage.width(),\r\n                h: this.$stage.height()\r\n            }, this.$stage, this.isRotated);\r\n            if (!this.imageLoaded) {\r\n                this.$stage.find(Constants.CLASS_NS + '-loader').remove();\r\n                this.$stage.removeClass('stage-ready');\r\n                this.$image.removeClass('image-ready');\r\n                if (this.options.initAnimation && !this.options.progressiveLoading) {\r\n                    this.$image.fadeIn();\r\n                }\r\n                this.imageLoaded = true;\r\n            }\r\n        },\r\n\r\n        loadImage : function(imgSrc, fn, err) {\r\n            this.$image.removeAttr('style').attr('src', '');\r\n            this.isRotated = false;\r\n            this.rotateAngle = 0;\r\n            this.imageLoaded = false;\r\n            this.$stage.append(`<div class=\"${ Constants.NS }-loader\"></div>`);\r\n            this.$stage.addClass('stage-ready');\r\n            this.$image.addClass('image-ready');\r\n            if (this.options.initAnimation && !this.options.progressiveLoading) {\r\n                this.$image.hide();\r\n            }\r\n            this.$image.attr('src', imgSrc);\r\n            Utilities.preloadImage(imgSrc, img => {\r\n                this.img = img;\r\n                this.imageData = {\r\n                    originalWidth: img.width,\r\n                    originalHeight: img.height\r\n                };\r\n                ///if (this.isMaximized || this.isOpened && this.options.fixedModalPos) {\r\n                ///    this.setImageSize(img);\r\n                ///} else {\r\n                ///    this.setModalSize(img);\r\n                ///}\r\n                if (fn) {\r\n                    fn(img);\r\n                }\r\n            }, () => {\r\n                this.$photoviewer.find(Constants.CLASS_NS + '-loader').remove();\r\n                if (err) {\r\n                    err.call();\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        _handleWheel : function(e) {\r\n            e.preventDefault();\r\n            let delta = 1;\r\n            if (e.deltaY) {\r\n                delta = e.deltaY > 0 ? 1 : -1;\r\n            } else if (e.wheelDelta) {\r\n                delta = -e.wheelDelta / 120;\r\n            } else if (e.detail) {\r\n                delta = e.detail > 0 ? 1 : -1;\r\n            }\r\n            const ratio = -delta * this.options.ratioThreshold;\r\n            const pointer = {\r\n                x: e.clientX - this.$stage.offset().left + Constants.$D.scrollLeft(),\r\n                y: e.clientY - this.$stage.offset().top + Constants.$D.scrollTop()\r\n            };\r\n            this.zoom(ratio, pointer, e);\r\n        },\r\n\r\n        zoom : function(ratio, origin, e) {\r\n            ratio = ratio < 0 ? 1 / (1 - ratio) : 1 + ratio;\r\n            ratio = this.$image.width() / this.imageData.originalWidth * ratio;\r\n            if (ratio > this.options.maxRatio || ratio < this.options.minRatio) {\r\n                return;\r\n            }\r\n            this.zoomTo(ratio, origin, e);\r\n        },\r\n\r\n        zoomTo : function(ratio, origin, e) {\r\n            const $image = this.$image;\r\n            const $stage = this.$stage;\r\n            const imgData = {\r\n                w: this.imageData.width,\r\n                h: this.imageData.height,\r\n                x: this.imageData.left,\r\n                y: this.imageData.top\r\n            };\r\n            const stageData = {\r\n                w: $stage.width(),\r\n                h: $stage.height(),\r\n                x: $stage.offset().left,\r\n                y: $stage.offset().top\r\n            };\r\n            const newWidth = this.imageData.originalWidth * ratio;\r\n            const newHeight = this.imageData.originalHeight * ratio;\r\n            let newLeft = origin.x - (origin.x - imgData.x) / imgData.w * newWidth;\r\n            let newTop = origin.y - (origin.y - imgData.y) / imgData.h * newHeight;\r\n            const Î´ = !this.isRotated ? 0 : (newWidth - newHeight) / 2;\r\n            const imgNewWidth = !this.isRotated ? newWidth : newHeight;\r\n            const imgNewHeight = !this.isRotated ? newHeight : newWidth;\r\n            const offsetX = stageData.w - newWidth;\r\n            const offsetY = stageData.h - newHeight;\r\n            if (imgNewHeight <= stageData.h) {\r\n                newTop = (stageData.h - newHeight) / 2;\r\n            } else {\r\n                newTop = newTop > Î´ ? Î´ : newTop > offsetY - Î´ ? newTop : offsetY - Î´;\r\n            }\r\n            if (imgNewWidth <= stageData.w) {\r\n                newLeft = (stageData.w - newWidth) / 2;\r\n            } else {\r\n                newLeft = newLeft > -Î´ ? -Î´ : newLeft > offsetX + Î´ ? newLeft : offsetX + Î´;\r\n            }\r\n            if (Math.abs(this.imageData.initWidth - newWidth) < this.imageData.initWidth * 0.05) {\r\n                this.setImageSize(this.img);\r\n            } else {\r\n                $image.css({\r\n                    width: Math.round(newWidth) + 'px',\r\n                    height: Math.round(newHeight) + 'px',\r\n                    left: Math.round(newLeft) + 'px',\r\n                    top: Math.round(newTop) + 'px'\r\n                });\r\n                Utilities.setGrabCursor({\r\n                    w: Math.round(imgNewWidth),\r\n                    h: Math.round(imgNewHeight)\r\n                }, {\r\n                    w: stageData.w,\r\n                    h: stageData.h\r\n                }, this.$stage);\r\n            }\r\n            $.extend(this.imageData, {\r\n                width: newWidth,\r\n                height: newHeight,\r\n                left: newLeft,\r\n                top: newTop\r\n            });\r\n        },\r\n\r\n        rotate : function(angle) {\r\n            this.rotateAngle = this.rotateAngle + angle;\r\n            if (this.rotateAngle / 90 % 2 === 0) {\r\n                this.isRotated = false;\r\n            } else {\r\n                this.isRotated = true;\r\n            }\r\n            this.rotateTo(this.rotateAngle);\r\n        },\r\n        rotateTo: function(angle) {\r\n            this.$image.css({ transform: 'rotate(' + angle + 'deg)' });\r\n            this.setImageSize({\r\n                width: this.imageData.originalWidth,\r\n                height: this.imageData.originalHeight\r\n            });\r\n            this.$stage.removeClass('is-grab');\r\n        },\r\n        resize: function() {\r\n            const imageWidth = this.$image.width();\r\n            const imageHeight = this.$image.height();\r\n            const stageWidth = this.$stage.width();\r\n            const stageHeight = this.$stage.height();\r\n            const left = (stageWidth - imageWidth) /2;\r\n            const top = (stageHeight- imageHeight) /2;\r\n            this.$image.css({\r\n                left,\r\n                top\r\n            });\r\n        },\r\n\r\n        shortcut: function(keyCode,ctrlKey,altKey) {\r\n            var handled = false;\r\n            switch (keyCode) {\r\n                // +\r\n                case 187:\r\n                    this.zoom(this.options.ratioThreshold * 3, {\r\n                        x: this.$stage.width() / 2,\r\n                        y: this.$stage.height() / 2\r\n                    }, e);\r\n                    handled = true;\r\n                    break;\r\n                // -\r\n                case 189:\r\n                    this.zoom(-this.options.ratioThreshold * 3, {\r\n                        x: this.$stage.width() / 2,\r\n                        y: this.$stage.height() / 2\r\n                    }, e);\r\n                    handled = true;\r\n                    break;\r\n                // + Firefox\r\n                case 61:\r\n                    this.zoom(this.options.ratioThreshold * 3, {\r\n                        x: this.$stage.width() / 2,\r\n                        y: this.$stage.height() / 2\r\n                    }, e);\r\n                    handled = true;\r\n                    break;\r\n                // - Firefox\r\n                case 173:\r\n                    this.zoom(-this.options.ratioThreshold * 3, {\r\n                        x: this.$stage.width() / 2,\r\n                        y: this.$stage.height() / 2\r\n                    }, e);\r\n                    handled = true;\r\n                    break;\r\n                // Ctrl + Alt + 0\r\n                case 48:\r\n                    if (ctrlKey && altKey) {\r\n                        this.zoomTo(1, {\r\n                            x: this.$stage.width() / 2,\r\n                            y: this.$stage.height() / 2\r\n                        }, e);\r\n                    }\r\n                    handled = true;\r\n                    break;\r\n                // Ctrl + ,\r\n                case 188:\r\n                    if (ctrlKey) {\r\n                        this.rotate(-90);\r\n                    }\r\n                    break;\r\n                // Ctrl + .\r\n                case 190:\r\n                    if (ctrlKey) {\r\n                        this.rotate(90);\r\n                    }\r\n                    handled = true;\r\n                    break;\r\n                default:\r\n            }\r\n\r\n            return handled;\r\n        }\r\n    });\r\n\r\n    return Imager;\r\n});\ndefine('skylark-photoviewer/core',[\n    './domq',\n    './defaults',\n    './constants',\n    './utilities',\n    \"./window\",\n    \"./picture_viewer\"\n], function ($, DEFAULTS, Constants, Utilities, Window,Imager) {\n    'use strict';\n\n    \n    class PhotoViewer {\n        constructor(items, options, el) {\n            this.options = $.extend(true, {}, DEFAULTS, options);\n            if (options && $.isArray(options.footerToolbar)) {\n                this.options.footerToolbar = options.footerToolbar;\n            }\n            if (options && $.isArray(options.headerToolbar)) {\n                this.options.headerToolbar = options.headerToolbar;\n            }\n            this.$el = $(el);\n            this.isOpened = false;\n            this.isMaximized = false;\n            this.isRotated = false;\n            this.rotateAngle = 0;\n            this.isDoResize = false;\n            this.imageData = {};\n            this.modalData = {\n                width: null,\n                height: null,\n                left: null,\n                top: null\n            };\n            this.init(items, this.options);\n        }\n        init(items, opts) {\n            this.groupData = items;\n            this.groupIndex = opts['index'];\n            Constants.PUBLIC_VARS['zIndex'] = Constants.PUBLIC_VARS['zIndex'] === 0 ? opts['zIndex'] : Constants.PUBLIC_VARS['zIndex'];\n            const imgSrc = items[this.groupIndex]['src'];\n            this.open();\n            this.loadImage(imgSrc);\n            ///if (opts.draggable) {\n            ///    this.draggable(this.$photoviewer, this.dragHandle, Constants.CLASS_NS + '-button');\n            ///}\n            ///if (opts.movable) {\n            ///    this.movable(this.$stage, this.$image);\n            ///}\n            ///if (opts.resizable) {\n            ///    this.resizable(this.$photoviewer, this.$stage, this.$image, opts.modalWidth, opts.modalHeight);\n            ///}\n        }\n        _createBtns(toolbar) {\n            const btns = [\n                'minimize',\n                'maximize',\n                'close',\n                'zoomIn',\n                'zoomOut',\n                'prev',\n                'next',\n                'fullscreen',\n                'actualSize',\n                'rotateLeft',\n                'rotateRight'\n            ];\n            let btnsHTML = '';\n            $.each(toolbar, (index, item) => {\n                const btnClass = `${ Constants.NS }-button ${ Constants.NS }-button-${ item }`;\n                if (btns.indexOf(item) >= 0) {\n                    btnsHTML += `<button class=\"${ btnClass }\" title=\"${ this.options.i18n[item] }\">\n          ${ this.options.icons[item] }\n          </button>`;\n                } else if (this.options.customButtons[item]) {\n                    btnsHTML += `<button class=\"${ btnClass }\" title=\"${ this.options.customButtons[item].title || '' }\">\n          ${ this.options.customButtons[item].text }\n          </button>`;\n                }\n            });\n            return btnsHTML;\n        }\n        _createTitle() {\n            return this.options.title ? `<div class=\"${ Constants.NS }-title\"></div>` : '';\n        }\n        _createTemplate() {\n            const photoviewerHTML = `<div class=\"${ Constants.NS }-modal\" tabindex=\"0\">\n        <div class=\"${ Constants.NS }-inner\">\n          <div class=\"${ Constants.NS }-header\">\n            <div class=\"${ Constants.NS }-toolbar ${ Constants.NS }-toolbar-header\">\n            ${ this._createBtns(this.options.headerToolbar) }\n            </div>\n            ${ this._createTitle() }\n          </div>\n          <div class=\"${ Constants.NS }-stage\">\n            <img class=\"${ Constants.NS }-image\" src=\"\" alt=\"\" />\n          </div>\n          <div class=\"${ Constants.NS }-footer\">\n            <div class=\"${ Constants.NS }-toolbar ${ Constants.NS }-toolbar-footer\">\n            ${ this._createBtns(this.options.footerToolbar) }\n            </div>\n          </div>\n        </div>\n      </div>`;\n            return photoviewerHTML;\n        }\n        build() {\n            const photoviewerHTML = this._createTemplate();\n            const $photoviewer = $(photoviewerHTML);\n            this.$photoviewer = $photoviewer;\n            this.$stage = $photoviewer.find(Constants.CLASS_NS + '-stage');\n            this.$title = $photoviewer.find(Constants.CLASS_NS + '-title');\n            this.$image = $photoviewer.find(Constants.CLASS_NS + '-image');\n            this.$close = $photoviewer.find(Constants.CLASS_NS + '-button-close');\n            this.$maximize = $photoviewer.find(Constants.CLASS_NS + '-button-maximize');\n            this.$minimize = $photoviewer.find(Constants.CLASS_NS + '-button-minimize');\n            this.$zoomIn = $photoviewer.find(Constants.CLASS_NS + '-button-zoomIn');\n            this.$zoomOut = $photoviewer.find(Constants.CLASS_NS + '-button-zoomOut');\n            this.$actualSize = $photoviewer.find(Constants.CLASS_NS + '-button-actualSize');\n            this.$fullscreen = $photoviewer.find(Constants.CLASS_NS + '-button-fullscreen');\n            this.$rotateLeft = $photoviewer.find(Constants.CLASS_NS + '-button-rotateLeft');\n            this.$rotateRight = $photoviewer.find(Constants.CLASS_NS + '-button-rotateRight');\n            this.$prev = $photoviewer.find(Constants.CLASS_NS + '-button-prev');\n            this.$next = $photoviewer.find(Constants.CLASS_NS + '-button-next');\n            this.$stage.addClass('stage-ready');\n            this.$image.addClass('image-ready');\n            this.$photoviewer.css('z-index', Constants.PUBLIC_VARS['zIndex']);\n            if (!this.options.dragHandle || this.options.dragHandle === Constants.CLASS_NS + '-modal') {\n                this.dragHandle = this.$photoviewer;\n            } else {\n                this.dragHandle = this.$photoviewer.find(this.options.dragHandle);\n            }\n            $(this.options.appendTo).eq(0).append(this.$photoviewer);\n\n            this._window = new Window(this.$photoviewer[0],{\n                dragHandle : this.options.dragHandle,\n\n            });\n            this._imager = new Imager(this.$stage[0]);\n\n            this._addEvents();\n            this._addCustomButtonEvents();\n\n            this.$photoviewer.on(\"resized\",()=>{\n                this._imager.resize();;\n            });\n        }\n        open() {\n            this._triggerHook('beforeOpen', this);\n            if (!this.options.multiInstances) {\n                $(Constants.CLASS_NS + '-modal').eq(0).remove();\n            }\n            if (!$(Constants.CLASS_NS + '-modal').length && this.options.fixedContent) {\n                $('html').css({ overflow: 'hidden' });\n                if (Utilities.hasScrollbar()) {\n                    const scrollbarWidth = Utilities.getScrollbarWidth();\n                    if (scrollbarWidth) {\n                        $('html').css({ 'padding-right': scrollbarWidth });\n                    }\n                }\n            }\n            this.build();\n            this.setModalPos(this.$photoviewer);\n            this.$photoviewer.get(0).focus();\n            this._triggerHook('opened', this);\n        }\n        close() {\n            this._window.close();\n        }\n        setModalPos(modal) {\n            const winWidth = Constants.$W.width();\n            const winHeight = Constants.$W.height();\n            const scrollLeft = Constants.$D.scrollLeft();\n            const scrollTop = Constants.$D.scrollTop();\n            const modalWidth = this.options.modalWidth;\n            const modalHeight = this.options.modalHeight;\n            if (this.options.initMaximized) {\n                modal.addClass(Constants.NS + '-maximize');\n                modal.css({\n                    width: '100%',\n                    height: '100%',\n                    left: 0,\n                    top: 0\n                });\n                this.isOpened = true;\n                this.isMaximized = true;\n            } else {\n                modal.css({\n                    width: modalWidth,\n                    height: modalHeight,\n                    left: (winWidth - modalWidth) / 2 + scrollLeft + 'px',\n                    top: (winHeight - modalHeight) / 2 + scrollTop + 'px'\n                });\n            }\n        }\n        setModalSize(img) {\n            const winWidth = Constants.$W.width();\n            const winHeight = Constants.$W.height();\n            const scrollLeft = Constants.$D.scrollLeft();\n            const scrollTop = Constants.$D.scrollTop();\n            const stageCSS = {\n                left: this.$stage.css('left'),\n                right: this.$stage.css('right'),\n                top: this.$stage.css('top'),\n                bottom: this.$stage.css('bottom'),\n                borderLeft: this.$stage.css('border-left-width'),\n                borderRight: this.$stage.css('border-right-width'),\n                borderTop: this.$stage.css('border-top-width'),\n                borderBottom: this.$stage.css('border-bottom-width')\n            };\n            const modalWidth = img.width + parseFloat(stageCSS.left) + parseFloat(stageCSS.right) + parseFloat(stageCSS.borderLeft) + parseFloat(stageCSS.borderRight);\n            const modalHeight = img.height + parseFloat(stageCSS.top) + parseFloat(stageCSS.bottom) + parseFloat(stageCSS.borderTop) + parseFloat(stageCSS.borderBottom);\n            const gapThreshold = (this.options.gapThreshold > 0 ? this.options.gapThreshold : 0) + 1;\n            const scale = Math.min(winWidth / (modalWidth * gapThreshold), winHeight / (modalHeight * gapThreshold), 1);\n            let minWidth = Math.max(modalWidth * scale, this.options.modalWidth);\n            let minHeight = Math.max(modalHeight * scale, this.options.modalHeight);\n            minWidth = this.options.fixedModalSize ? this.options.modalWidth : Math.round(minWidth);\n            minHeight = this.options.fixedModalSize ? this.options.modalHeight : Math.round(minHeight);\n            const modalCSSObj = {\n                width: minWidth + 'px',\n                height: minHeight + 'px',\n                left: (winWidth - minWidth) / 2 + scrollLeft + 'px',\n                top: (winHeight - minHeight) / 2 + scrollTop + 'px'\n            };\n            if (this.options.initAnimation) {\n                this.$photoviewer.animate(modalCSSObj, 400, 'ease-in-out', () => {\n                    this.setImageSize(img);\n                });\n            } else {\n                this.$photoviewer.css(modalCSSObj);\n                this.setImageSize(img);\n            }\n            this.isOpened = true;\n        }\n\n        setImageSize(img) {\n            this._imager.setImageSize(img);\n        }\n        loadImage(imgSrc, fn, err) {\n            this._imager.loadImage(imgSrc,(img) => {\n                this.setModalSize(img);\n                if (fn) {\n                    fn.call();\n                }\n            },err);\n            if (this.options.title) {\n                this.setImageTitle(imgSrc);\n            }\n        }\n        setImageTitle(url) {\n            const title = this.groupData[this.groupIndex].title || Utilities.getImageNameFromUrl(url);\n            this.$title.html(title);\n        }\n        jump(step) {\n            this._triggerHook('beforeChange', [\n                this,\n                this.groupIndex\n            ]);\n            this.groupIndex = this.groupIndex + step;\n            this.jumpTo(this.groupIndex);\n        }\n        jumpTo(index) {\n            index = index % this.groupData.length;\n            if (index >= 0) {\n                index = index % this.groupData.length;\n            } else if (index < 0) {\n                index = (this.groupData.length + index) % this.groupData.length;\n            }\n            this.groupIndex = index;\n            this.loadImage(this.groupData[index].src, () => {\n                this._triggerHook('changed', [\n                    this,\n                    index\n                ]);\n            }, () => {\n                this._triggerHook('changed', [\n                    this,\n                    index\n                ]);\n            });\n        }\n        zoom(ratio, origin, e) {\n            this._imager.zoom(ratio,origin,e);\n        }\n        zoomTo(ratio, origin, e) {\n            this._imager.zoomTo(ratio,origin,e);\n        }\n        rotate(angle) {\n            this._imager.rotate(angle);\n        }\n        rotateTo(angle) {\n            this._imager.rotateTo(angle);\n        }\n        resize() {\n            return this._imager.resize();\n        }\n        maximize() {\n            this._window.maximize();\n        }\n        fullscreen() {\n            this._window.fullscreen();\n        }\n        _keydown(e) {\n            if (!this.options.keyboard) {\n                return false;\n            }\n            const keyCode = e.keyCode || e.which || e.charCode;\n            const ctrlKey = e.ctrlKey || e.metaKey;\n            const altKey = e.altKey || e.metaKey;\n            switch (keyCode) {\n                // â\n                case 37:\n                    this.jump(-1);\n                    break;\n                // â\n                case 39:\n                    this.jump(1);\n                    break;\n                // Q\n                case 81:\n                    this.close();\n                    break;\n                default:\n            }\n        }\n        _addEvents() {\n\n            this.$zoomIn.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\n                this.zoom(this.options.ratioThreshold * 3, {\n                    x: this.$stage.width() / 2,\n                    y: this.$stage.height() / 2\n                }, e);\n            });\n            this.$zoomOut.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\n                this.zoom(-this.options.ratioThreshold * 3, {\n                    x: this.$stage.width() / 2,\n                    y: this.$stage.height() / 2\n                }, e);\n            });\n            this.$actualSize.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\n                this.zoomTo(1, {\n                    x: this.$stage.width() / 2,\n                    y: this.$stage.height() / 2\n                }, e);\n            });\n            this.$prev.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\n                this.jump(-1);\n            });\n\n            this.$next.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\n                this.jump(1);\n            });\n            this.$rotateLeft.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\n                this.rotate(-90);\n            });\n            this.$rotateRight.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\n                this.rotate(90);\n            });\n\n            this.$photoviewer.off(Constants.KEYDOWN_EVENT + Constants.EVENT_NS).on(Constants.KEYDOWN_EVENT + Constants.EVENT_NS, e => {\n                this._keydown(e);\n            });\n            ///Constants.$W.on(Constants.RESIZE_EVENT + Constants.EVENT_NS, this.resize());\n        }\n        _addCustomButtonEvents() {\n            for (const btnKey in this.options.customButtons) {\n                this.$photoviewer.find(Constants.CLASS_NS + '-button-' + btnKey).off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\n                    this.options.customButtons[btnKey].click.apply(this, [\n                        this,\n                        e\n                    ]);\n                });\n            }\n        }\n        _triggerHook(e, data) {\n            if (this.options.callbacks[e]) {\n                this.options.callbacks[e].apply(this, $.isArray(data) ? data : [data]);\n            }\n        }\n    }\n    //$.extend(PhotoViewer.prototype, draggable, movable, resizable);\n\n    ///$.extend(PhotoViewer.prototype, movable);\n\n    window.PhotoViewer = PhotoViewer;\n    return PhotoViewer;\n});\ndefine('skylark-photoviewer/main',[\n\t'./core'\n], function (PhotoViewer) {\n    'use strict';\n    return PhotoViewer;\n});\ndefine('skylark-photoviewer', ['skylark-photoviewer/main'], function (main) { return main; });\n\n"]}