{"version":3,"sources":["skylark-photoviewer.js"],"names":["define","$","draggable","resizable","movable","keyboard","title","modalWidth","modalHeight","fixedContent","fixedModalSize","initMaximized","gapThreshold","ratioThreshold","minRatio","maxRatio","headerToolbar","footerToolbar","icons","minimize","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight","i18n","multiInstances","initAnimation","fixedModalPos","zIndex","dragHandle","callbacks","beforeOpen","noop","opened","beforeClose","closed","beforeChange","changed","index","progressiveLoading","appendTo","customButtons","langx","browser","noder","geom","images","document","window","throttle","debounce","preloadImage","src","success","error","preload","then","data","imgs","requestFullscreen","exitFullscreen","getImageNameFromUrl","url","replace","hasScrollbar","getScrollbarWidth","scrollbarWidth","setGrabCursor","imageData","stageData","stage","isRotated","imageWidth","h","w","imageHeight","addClass","removeClass","supportTouch","support","tocuh","utilities","$W","$D","TOUCH_START_EVENT","TOUCH_MOVE_EVENT","TOUCH_END_EVENT","NS","CLICK_EVENT","RESIZE_EVENT","KEYDOWN_EVENT","WHEEL_EVENT","CLASS_NS","EVENT_NS","PUBLIC_VARS","isMoving","isResizing","Imager","Window","DEFAULTS","Constants","Utilities","PhotoViewer","[object Object]","items","options","el","this","extend","isArray","$el","isOpened","isMaximized","rotateAngle","isDoResize","modalData","width","height","left","top","init","opts","groupData","groupIndex","imgSrc","open","loadImage","toolbar","btns","btnsHTML","each","item","btnClass","indexOf","text","photoviewerHTML","_createBtns","_createTitle","_createTemplate","$photoviewer","$stage","find","$title","$image","$close","$maximize","$minimize","$zoomIn","$zoomOut","$actualSize","$fullscreen","$rotateLeft","$rotateRight","$prev","$next","css","eq","append","_window","selectors","headerPane","contentPane","footerPane","titlebar","buttons","classes","dragCancel","minWidth","minHeight","border","all","right","bottom","topLeft","topRight","bottomLeft","bottomRight","_imager","grab","loader","_addEvents","_addCustomButtonEvents","on","resize","_triggerHook","remove","length","overflow","padding-right","build","setModalPos","get","focus","modal","winWidth","winHeight","scrollLeft","scrollTop","img","stageCSS","borderLeft","borderRight","borderTop","borderBottom","parseFloat","scale","Math","min","max","round","modalCSSObj","animate","setImageSize","fn","err","setModalSize","call","setImageTitle","html","step","jumpTo","ratio","origin","e","zoom","zoomTo","angle","rotate","rotateTo","keyCode","which","charCode","ctrlKey","metaKey","altKey","jump","off","x","y","_keydown","btnKey","click","apply","main"],"mappings":"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","file":"../skylark-photoviewer.js","sourcesContent":["define('skylark-photoviewer/domq',['skylark-jquery'], function ($) {\r\n    'use strict';\r\n\r\n    return $;\r\n});\ndefine('skylark-photoviewer/defaults',[\r\n    './domq'\r\n], function ($) {\r\n    'use strict';\r\n    return {\r\n        draggable: true,\r\n        resizable: true,\r\n        movable: true,\r\n        keyboard: true,\r\n        title: true,\r\n        modalWidth: 320,\r\n        modalHeight: 320,\r\n        fixedContent: true,\r\n        fixedModalSize: false,\r\n        initMaximized: false,\r\n        gapThreshold: 0.02,\r\n        ratioThreshold: 0.1,\r\n        minRatio: 0.05,\r\n        maxRatio: 16,\r\n        headerToolbar: [\r\n            'maximize',\r\n            'close'\r\n        ],\r\n        footerToolbar: [\r\n            'zoomIn',\r\n            'zoomOut',\r\n            'prev',\r\n            'fullscreen',\r\n            'next',\r\n            'actualSize',\r\n            'rotateRight'\r\n        ],\r\n        icons: {\r\n            minimize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M20,14H4V10H20\"></path>\r\n      </svg>`,\r\n            maximize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M4,4H20V20H4V4M6,8V18H18V8H6Z\"></path>\r\n      </svg>`,\r\n            close: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12\r\n        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z\"></path>\r\n      </svg>`,\r\n            zoomIn: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\r\n        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5\r\n        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5\r\n        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z\"></path>\r\n      </svg>`,\r\n            zoomOut: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5\r\n        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16\r\n        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14\r\n        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z\"></path>\r\n      </svg>`,\r\n            prev: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z\"></path>\r\n      </svg>`,\r\n            next: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M16,18H18V6H16M6,18L14.5,12L6,6V18Z\"></path>\r\n      </svg>`,\r\n            fullscreen: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3\r\n        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z\"></path>\r\n      </svg>`,\r\n            actualSize: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09\r\n        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19\r\n        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\r\n        L13.09,9.5Z\"></path>\r\n      </svg>`,\r\n            rotateLeft: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12\r\n        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07\r\n        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32\r\n        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13\r\n        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z\"></path>\r\n      </svg>`,\r\n            rotateRight: `<svg viewBox=\"0 0 24 24\" class=\"svg-inline-icon\">\r\n        <path fill=\"currentColor\" d=\"M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91\r\n        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31\r\n        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11\r\n        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12\r\n        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10\r\n        L15.55,5.55Z\"></path>\r\n      </svg>`\r\n        },\r\n        i18n: {\r\n            minimize: 'minimize',\r\n            maximize: 'maximize',\r\n            close: 'close',\r\n            zoomIn: 'zoom-in (+)',\r\n            zoomOut: 'zoom-out (-)',\r\n            prev: 'prev (\\u2190)',\r\n            next: 'next (\\u2192)',\r\n            fullscreen: 'fullscreen',\r\n            actualSize: 'actual-size (Ctrl+Alt+0)',\r\n            rotateLeft: 'rotate-left (Ctrl+,)',\r\n            rotateRight: 'rotate-right (Ctrl+.)'\r\n        },\r\n        multiInstances: true,\r\n        initAnimation: true,\r\n        fixedModalPos: false,\r\n        zIndex: 1090,\r\n        dragHandle: false,\r\n        callbacks: {\r\n            beforeOpen: $.noop,\r\n            opened: $.noop,\r\n            beforeClose: $.noop,\r\n            closed: $.noop,\r\n            beforeChange: $.noop,\r\n            changed: $.noop\r\n        },\r\n        index: 0,\r\n        progressiveLoading: true,\r\n        appendTo: 'body',\r\n        customButtons: {}\r\n    };\r\n});\ndefine('skylark-photoviewer/utilities',[\r\n    \"skylark-langx\",\r\n    \"skylark-domx-browser\",\r\n    \"skylark-domx-noder\",\r\n    \"skylark-domx-geom\",\r\n    \"skylark-domx-images\"\r\n],function (langx,browser,noder,geom,images) {\r\n    'use strict';\r\n    const document = window.document;\r\n\r\n    /*\r\n    function throttle(fn, delay) {\r\n        let timer = null;\r\n        return function () {\r\n            const context = this;\r\n            const args = arguments;\r\n            clearTimeout(timer);\r\n            timer = setTimeout(function () {\r\n                fn.apply(context, args);\r\n            }, delay);\r\n        };\r\n    }\r\n    function preloadImage(src, success, error) {\r\n        const img = new Image();\r\n        img.onload = function () {\r\n            success(img);\r\n        };\r\n        img.onerror = function () {\r\n            error(img);\r\n        };\r\n        img.src = src;\r\n    }\r\n    function requestFullscreen(element) {\r\n        if (element.requestFullscreen) {\r\n            element.requestFullscreen();\r\n        } else if (element.mozRequestFullScreen) {\r\n            element.mozRequestFullScreen();\r\n        } else if (element.webkitRequestFullscreen) {\r\n            element.webkitRequestFullscreen();\r\n        } else if (element.msRequestFullscreen) {\r\n            element.msRequestFullscreen();\r\n        }\r\n    }\r\n    function exitFullscreen() {\r\n        if (document.exitFullscreen) {\r\n            document.exitFullscreen();\r\n        } else if (document.mozCancelFullScreen) {\r\n            document.mozCancelFullScreen();\r\n        } else if (document.webkitExitFullscreen) {\r\n            document.webkitExitFullscreen();\r\n        }\r\n    }\r\n\r\n\r\n    function getScrollbarWidth() {\r\n        const scrollDiv = document.createElement('div');\r\n        scrollDiv.style.cssText = 'width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';\r\n        document.body.appendChild(scrollDiv);\r\n        const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n        document.body.removeChild(scrollDiv);\r\n        return scrollbarWidth;\r\n    }\r\n\r\n    function hasScrollbar() {\r\n        return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);\r\n    }\r\n\r\n\r\n    function supportTouch() {\r\n        return !!('ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch);\r\n    }\r\n\r\n    */\r\n \r\n\r\n     function setGrabCursor(imageData, stageData, stage, isRotated) {\r\n        const imageWidth = !isRotated ? imageData.w : imageData.h;\r\n        const imageHeight = !isRotated ? imageData.h : imageData.w;\r\n        if (imageHeight > stageData.h || imageWidth > stageData.w) {\r\n            stage.addClass('is-grab');\r\n        }\r\n        if (imageHeight <= stageData.h && imageWidth <= stageData.w) {\r\n            stage.removeClass('is-grab');\r\n        }\r\n    }\r\n\r\n    function getImageNameFromUrl(url) {\r\n        const reg = /^.*?\\/*([^/?]*)\\.[a-z]+(\\?.+|$)/gi;\r\n        const txt = url.replace(reg, '$1');\r\n        return txt;\r\n    }\r\n\r\n    return {\r\n        document: document,\r\n        throttle: langx.debounce,\r\n        preloadImage: function preloadImage(src, success, error) {\r\n            images.preload(src).then(function(data){\r\n                success(data.imgs[0]);\r\n            },error);\r\n        },\r\n        requestFullscreen: noder.fullscreen,\r\n        exitFullscreen: noder.fullscreen,\r\n        getImageNameFromUrl: getImageNameFromUrl,\r\n        hasScrollbar: geom.hasScrollbar,\r\n        getScrollbarWidth: geom.scrollbarWidth,\r\n        setGrabCursor: setGrabCursor,\r\n        supportTouch: function() {\r\n            return browser.support.tocuh;\r\n        }\r\n    }\r\n});\ndefine('skylark-photoviewer/constants',[\r\n    './domq',\r\n    './utilities'\r\n], function ($, utilities) {\r\n    'use strict';\r\n    const $W = $(window);\r\n    const $D = $(utilities.document);\r\n    const CLICK_EVENT = 'click';\r\n    const RESIZE_EVENT = 'resize';\r\n    const KEYDOWN_EVENT = 'keydown';\r\n    const WHEEL_EVENT = 'wheel mousewheel DOMMouseScroll';\r\n    const TOUCH_START_EVENT = utilities.supportTouch() ? 'touchstart' : 'mousedown';\r\n    const TOUCH_MOVE_EVENT = utilities.supportTouch() ? 'touchmove' : 'mousemove';\r\n    const TOUCH_END_EVENT = utilities.supportTouch() ? 'touchend' : 'mouseup';\r\n    const NS = 'photoviewer';\r\n    const CLASS_NS = '.' + NS;\r\n    const EVENT_NS = '.' + NS;\r\n    const PUBLIC_VARS = {\r\n        isMoving: false,\r\n        isResizing: false,\r\n        zIndex: 0\r\n    };\r\n    return {\r\n        $W: $W,\r\n        $D: $D,\r\n        CLICK_EVENT: CLICK_EVENT,\r\n        RESIZE_EVENT: RESIZE_EVENT,\r\n        KEYDOWN_EVENT: KEYDOWN_EVENT,\r\n        WHEEL_EVENT: WHEEL_EVENT,\r\n        TOUCH_START_EVENT: TOUCH_START_EVENT,\r\n        TOUCH_MOVE_EVENT: TOUCH_MOVE_EVENT,\r\n        TOUCH_END_EVENT: TOUCH_END_EVENT,\r\n        NS: NS,\r\n        CLASS_NS: CLASS_NS,\r\n        EVENT_NS: EVENT_NS,\r\n        PUBLIC_VARS: PUBLIC_VARS\r\n    };\r\n});\ndefine('skylark-photoviewer/core',[\r\n    \"skylark-domx-plugins-pictures/viewer\",\r\n    \"skylark-domx-plugins-panels/floating\",\r\n    './domq',\r\n    './defaults',\r\n    './constants',\r\n    './utilities'\r\n], function (Imager,Window,$, DEFAULTS, Constants, Utilities) {\r\n    'use strict';\r\n\r\n    \r\n    class PhotoViewer {\r\n        constructor(items, options, el) {\r\n            this.options = $.extend(true, {}, DEFAULTS, options);\r\n            if (options && $.isArray(options.footerToolbar)) {\r\n                this.options.footerToolbar = options.footerToolbar;\r\n            }\r\n            if (options && $.isArray(options.headerToolbar)) {\r\n                this.options.headerToolbar = options.headerToolbar;\r\n            }\r\n            this.$el = $(el);\r\n            this.isOpened = false;\r\n            this.isMaximized = false;\r\n            this.isRotated = false;\r\n            this.rotateAngle = 0;\r\n            this.isDoResize = false;\r\n            this.imageData = {};\r\n            this.modalData = {\r\n                width: null,\r\n                height: null,\r\n                left: null,\r\n                top: null\r\n            };\r\n            this.init(items, this.options);\r\n        }\r\n        init(items, opts) {\r\n            this.groupData = items;\r\n            this.groupIndex = opts['index'];\r\n            Constants.PUBLIC_VARS['zIndex'] = Constants.PUBLIC_VARS['zIndex'] === 0 ? opts['zIndex'] : Constants.PUBLIC_VARS['zIndex'];\r\n            const imgSrc = items[this.groupIndex]['src'];\r\n            this.open();\r\n            this.loadImage(imgSrc);\r\n            ///if (opts.draggable) {\r\n            ///    this.draggable(this.$photoviewer, this.dragHandle, Constants.CLASS_NS + '-button');\r\n            ///}\r\n            ///if (opts.movable) {\r\n            ///    this.movable(this.$stage, this.$image);\r\n            ///}\r\n            ///if (opts.resizable) {\r\n            ///    this.resizable(this.$photoviewer, this.$stage, this.$image, opts.modalWidth, opts.modalHeight);\r\n            ///}\r\n        }\r\n        _createBtns(toolbar) {\r\n            const btns = [\r\n                'minimize',\r\n                'maximize',\r\n                'close',\r\n                'zoomIn',\r\n                'zoomOut',\r\n                'prev',\r\n                'next',\r\n                'fullscreen',\r\n                'actualSize',\r\n                'rotateLeft',\r\n                'rotateRight'\r\n            ];\r\n            let btnsHTML = '';\r\n            $.each(toolbar, (index, item) => {\r\n                const btnClass = `${ Constants.NS }-button ${ Constants.NS }-button-${ item }`;\r\n                if (btns.indexOf(item) >= 0) {\r\n                    btnsHTML += `<button class=\"${ btnClass }\" title=\"${ this.options.i18n[item] }\">\r\n          ${ this.options.icons[item] }\r\n          </button>`;\r\n                } else if (this.options.customButtons[item]) {\r\n                    btnsHTML += `<button class=\"${ btnClass }\" title=\"${ this.options.customButtons[item].title || '' }\">\r\n          ${ this.options.customButtons[item].text }\r\n          </button>`;\r\n                }\r\n            });\r\n            return btnsHTML;\r\n        }\r\n        _createTitle() {\r\n            return this.options.title ? `<div class=\"${ Constants.NS }-title\"></div>` : '';\r\n        }\r\n        _createTemplate() {\r\n            const photoviewerHTML = `<div class=\"${ Constants.NS }-modal\" tabindex=\"0\">\r\n        <div class=\"${ Constants.NS }-inner\">\r\n          <div class=\"${ Constants.NS }-header\">\r\n            <div class=\"${ Constants.NS }-toolbar ${ Constants.NS }-toolbar-header\">\r\n            ${ this._createBtns(this.options.headerToolbar) }\r\n            </div>\r\n            ${ this._createTitle() }\r\n          </div>\r\n          <div class=\"${ Constants.NS }-stage\">\r\n            <img class=\"${ Constants.NS }-image\" src=\"\" alt=\"\" />\r\n          </div>\r\n          <div class=\"${ Constants.NS }-footer\">\r\n            <div class=\"${ Constants.NS }-toolbar ${ Constants.NS }-toolbar-footer\">\r\n            ${ this._createBtns(this.options.footerToolbar) }\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n            return photoviewerHTML;\r\n        }\r\n        build() {\r\n            const photoviewerHTML = this._createTemplate();\r\n            const $photoviewer = $(photoviewerHTML);\r\n            this.$photoviewer = $photoviewer;\r\n            this.$stage = $photoviewer.find(Constants.CLASS_NS + '-stage');\r\n            this.$title = $photoviewer.find(Constants.CLASS_NS + '-title');\r\n            this.$image = $photoviewer.find(Constants.CLASS_NS + '-image');\r\n            this.$close = $photoviewer.find(Constants.CLASS_NS + '-button-close');\r\n            this.$maximize = $photoviewer.find(Constants.CLASS_NS + '-button-maximize');\r\n            this.$minimize = $photoviewer.find(Constants.CLASS_NS + '-button-minimize');\r\n            this.$zoomIn = $photoviewer.find(Constants.CLASS_NS + '-button-zoomIn');\r\n            this.$zoomOut = $photoviewer.find(Constants.CLASS_NS + '-button-zoomOut');\r\n            this.$actualSize = $photoviewer.find(Constants.CLASS_NS + '-button-actualSize');\r\n            this.$fullscreen = $photoviewer.find(Constants.CLASS_NS + '-button-fullscreen');\r\n            this.$rotateLeft = $photoviewer.find(Constants.CLASS_NS + '-button-rotateLeft');\r\n            this.$rotateRight = $photoviewer.find(Constants.CLASS_NS + '-button-rotateRight');\r\n            this.$prev = $photoviewer.find(Constants.CLASS_NS + '-button-prev');\r\n            this.$next = $photoviewer.find(Constants.CLASS_NS + '-button-next');\r\n            this.$stage.addClass('stage-ready');\r\n            this.$image.addClass('image-ready');\r\n            this.$photoviewer.css('z-index', Constants.PUBLIC_VARS['zIndex']);\r\n            if (!this.options.dragHandle || this.options.dragHandle === Constants.CLASS_NS + '-modal') {\r\n                this.dragHandle = this.$photoviewer;\r\n            } else {\r\n                this.dragHandle = this.$photoviewer.find(this.options.dragHandle);\r\n            }\r\n            $(this.options.appendTo).eq(0).append(this.$photoviewer);\r\n\r\n            this._window = new Window(this.$photoviewer[0],{\r\n                selectors : {\r\n                    headerPane  : \"\",\r\n                    contentPane : \"\",\r\n                    footerPane  : \"\",\r\n                    titlebar : \"\",\r\n                    buttons : {\r\n                        \"fullscreen\" : \".photoviewer-button-fullscreen\",\r\n                        \"maximize\" : \".photoviewer-button-maximize\",\r\n                        \"minimize\" : \".photoviewer-button-minimize\",     \r\n                        \"close\" : \".photoviewer-button-close\"\r\n                    }\r\n                },\r\n                classes : {\r\n                    \"maximize\" : Constants.NS + '-maximize',\r\n                },\r\n                fixedContent: true,\r\n                initMaximized: false,\r\n\r\n\r\n\r\n                movable : {\r\n\r\n                    dragHandle: this.options.dragHandle,\r\n                    dragCancel: Constants.CLASS_NS + '-button'\r\n                },\r\n                resizable : {\r\n                    minWidth: 320,\r\n                    minHeight: 320,\r\n                    border : {\r\n                        classes :  {\r\n                            all : `${ Constants.NS }-resizable-handle`,\r\n                            top : `${ Constants.NS }-resizable-handle-n`,\r\n                            left: `${ Constants.NS }-resizable-handle-w`,\r\n                            right: `${ Constants.NS }-resizable-handle-e`,\r\n                            bottom: `${ Constants.NS }-resizable-handle-s`, \r\n                            topLeft : `${ Constants.NS }-resizable-handle-nw`, \r\n                            topRight : `${ Constants.NS }-resizable-handle-ne`,\r\n                            bottomLeft : `${ Constants.NS }-resizable-handle-sw`,             \r\n                            bottomRight : `${ Constants.NS }-resizable-handle-se`   \r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            this._imager = new Imager(this.$stage[0],{\r\n                ratioThreshold: this.options.ratioThreshold,\r\n                minRatio: this.options.minRatio,\r\n                maxRatio: this.options.maxRatio,\r\n                movable : true,\r\n\r\n                classes : {\r\n                    grab : \"is-grab\",\r\n                    loader : \"${ Constants.NS }-loader\"\r\n                }                \r\n            });\r\n\r\n            this._addEvents();\r\n            this._addCustomButtonEvents();\r\n\r\n            this.$photoviewer.on(\"resized\",()=>{\r\n                this._imager.resize();;\r\n            });\r\n        }\r\n        open() {\r\n            this._triggerHook('beforeOpen', this);\r\n            if (!this.options.multiInstances) {\r\n                $(Constants.CLASS_NS + '-modal').eq(0).remove();\r\n            }\r\n            if (!$(Constants.CLASS_NS + '-modal').length && this.options.fixedContent) {\r\n                $('html').css({ overflow: 'hidden' });\r\n                if (Utilities.hasScrollbar()) {\r\n                    const scrollbarWidth = Utilities.getScrollbarWidth();\r\n                    if (scrollbarWidth) {\r\n                        $('html').css({ 'padding-right': scrollbarWidth });\r\n                    }\r\n                }\r\n            }\r\n            this.build();\r\n            this.setModalPos(this.$photoviewer);\r\n            this.$photoviewer.get(0).focus();\r\n            this._triggerHook('opened', this);\r\n        }\r\n        close() {\r\n            this._window.close();\r\n        }\r\n        setModalPos(modal) {\r\n            const winWidth = Constants.$W.width();\r\n            const winHeight = Constants.$W.height();\r\n            const scrollLeft = Constants.$D.scrollLeft();\r\n            const scrollTop = Constants.$D.scrollTop();\r\n            const modalWidth = this.options.modalWidth;\r\n            const modalHeight = this.options.modalHeight;\r\n            if (this.options.initMaximized) {\r\n                modal.addClass(Constants.NS + '-maximize');\r\n                modal.css({\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    left: 0,\r\n                    top: 0\r\n                });\r\n                this.isOpened = true;\r\n                this.isMaximized = true;\r\n            } else {\r\n                modal.css({\r\n                    width: modalWidth,\r\n                    height: modalHeight,\r\n                    left: (winWidth - modalWidth) / 2 + scrollLeft + 'px',\r\n                    top: (winHeight - modalHeight) / 2 + scrollTop + 'px'\r\n                });\r\n            }\r\n        }\r\n        setModalSize(img) {\r\n            const winWidth = Constants.$W.width();\r\n            const winHeight = Constants.$W.height();\r\n            const scrollLeft = Constants.$D.scrollLeft();\r\n            const scrollTop = Constants.$D.scrollTop();\r\n            const stageCSS = {\r\n                left: this.$stage.css('left'),\r\n                right: this.$stage.css('right'),\r\n                top: this.$stage.css('top'),\r\n                bottom: this.$stage.css('bottom'),\r\n                borderLeft: this.$stage.css('border-left-width'),\r\n                borderRight: this.$stage.css('border-right-width'),\r\n                borderTop: this.$stage.css('border-top-width'),\r\n                borderBottom: this.$stage.css('border-bottom-width')\r\n            };\r\n            const modalWidth = img.width + parseFloat(stageCSS.left) + parseFloat(stageCSS.right) + parseFloat(stageCSS.borderLeft) + parseFloat(stageCSS.borderRight);\r\n            const modalHeight = img.height + parseFloat(stageCSS.top) + parseFloat(stageCSS.bottom) + parseFloat(stageCSS.borderTop) + parseFloat(stageCSS.borderBottom);\r\n            const gapThreshold = (this.options.gapThreshold > 0 ? this.options.gapThreshold : 0) + 1;\r\n            const scale = Math.min(winWidth / (modalWidth * gapThreshold), winHeight / (modalHeight * gapThreshold), 1);\r\n            let minWidth = Math.max(modalWidth * scale, this.options.modalWidth);\r\n            let minHeight = Math.max(modalHeight * scale, this.options.modalHeight);\r\n            minWidth = this.options.fixedModalSize ? this.options.modalWidth : Math.round(minWidth);\r\n            minHeight = this.options.fixedModalSize ? this.options.modalHeight : Math.round(minHeight);\r\n            const modalCSSObj = {\r\n                width: minWidth + 'px',\r\n                height: minHeight + 'px',\r\n                left: (winWidth - minWidth) / 2 + scrollLeft + 'px',\r\n                top: (winHeight - minHeight) / 2 + scrollTop + 'px'\r\n            };\r\n            if (this.options.initAnimation) {\r\n                this.$photoviewer.animate(modalCSSObj, 400, 'ease-in-out', () => {\r\n                    this.setImageSize(img);\r\n                });\r\n            } else {\r\n                this.$photoviewer.css(modalCSSObj);\r\n                this.setImageSize(img);\r\n            }\r\n            this.isOpened = true;\r\n        }\r\n\r\n        setImageSize(img) {\r\n            this._imager.setImageSize(img);\r\n        }\r\n        loadImage(imgSrc, fn, err) {\r\n            this._imager.loadImage(imgSrc,(img) => {\r\n                this.setModalSize(img);\r\n                if (fn) {\r\n                    fn.call();\r\n                }\r\n            },err);\r\n            if (this.options.title) {\r\n                this.setImageTitle(imgSrc);\r\n            }\r\n        }\r\n        setImageTitle(url) {\r\n            const title = this.groupData[this.groupIndex].title || Utilities.getImageNameFromUrl(url);\r\n            this.$title.html(title);\r\n        }\r\n        jump(step) {\r\n            this._triggerHook('beforeChange', [\r\n                this,\r\n                this.groupIndex\r\n            ]);\r\n            this.groupIndex = this.groupIndex + step;\r\n            this.jumpTo(this.groupIndex);\r\n        }\r\n        jumpTo(index) {\r\n            index = index % this.groupData.length;\r\n            if (index >= 0) {\r\n                index = index % this.groupData.length;\r\n            } else if (index < 0) {\r\n                index = (this.groupData.length + index) % this.groupData.length;\r\n            }\r\n            this.groupIndex = index;\r\n            this.loadImage(this.groupData[index].src, () => {\r\n                this._triggerHook('changed', [\r\n                    this,\r\n                    index\r\n                ]);\r\n            }, () => {\r\n                this._triggerHook('changed', [\r\n                    this,\r\n                    index\r\n                ]);\r\n            });\r\n        }\r\n        zoom(ratio, origin, e) {\r\n            this._imager.zoom(ratio,origin,e);\r\n        }\r\n        zoomTo(ratio, origin, e) {\r\n            this._imager.zoomTo(ratio,origin,e);\r\n        }\r\n        rotate(angle) {\r\n            this._imager.rotate(angle);\r\n        }\r\n        rotateTo(angle) {\r\n            this._imager.rotateTo(angle);\r\n        }\r\n        resize() {\r\n            return this._imager.resize();\r\n        }\r\n        maximize() {\r\n            this._window.maximize();\r\n        }\r\n        fullscreen() {\r\n            this._window.fullscreen();\r\n        }\r\n        _keydown(e) {\r\n            if (!this.options.keyboard) {\r\n                return false;\r\n            }\r\n            const keyCode = e.keyCode || e.which || e.charCode;\r\n            const ctrlKey = e.ctrlKey || e.metaKey;\r\n            const altKey = e.altKey || e.metaKey;\r\n            switch (keyCode) {\r\n                // ←\r\n                case 37:\r\n                    this.jump(-1);\r\n                    break;\r\n                // →\r\n                case 39:\r\n                    this.jump(1);\r\n                    break;\r\n                // Q\r\n                case 81:\r\n                    this.close();\r\n                    break;\r\n                default:\r\n            }\r\n        }\r\n        _addEvents() {\r\n\r\n            this.$zoomIn.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\r\n                this.zoom(this.options.ratioThreshold * 3, {\r\n                    x: this.$stage.width() / 2,\r\n                    y: this.$stage.height() / 2\r\n                }, e);\r\n            });\r\n            this.$zoomOut.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\r\n                this.zoom(-this.options.ratioThreshold * 3, {\r\n                    x: this.$stage.width() / 2,\r\n                    y: this.$stage.height() / 2\r\n                }, e);\r\n            });\r\n            this.$actualSize.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\r\n                this.zoomTo(1, {\r\n                    x: this.$stage.width() / 2,\r\n                    y: this.$stage.height() / 2\r\n                }, e);\r\n            });\r\n            this.$prev.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.jump(-1);\r\n            });\r\n\r\n            this.$next.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.jump(1);\r\n            });\r\n            this.$rotateLeft.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.rotate(-90);\r\n            });\r\n            this.$rotateRight.off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, () => {\r\n                this.rotate(90);\r\n            });\r\n\r\n            this.$photoviewer.off(Constants.KEYDOWN_EVENT + Constants.EVENT_NS).on(Constants.KEYDOWN_EVENT + Constants.EVENT_NS, e => {\r\n                this._keydown(e);\r\n            });\r\n            ///Constants.$W.on(Constants.RESIZE_EVENT + Constants.EVENT_NS, this.resize());\r\n        }\r\n        _addCustomButtonEvents() {\r\n            for (const btnKey in this.options.customButtons) {\r\n                this.$photoviewer.find(Constants.CLASS_NS + '-button-' + btnKey).off(Constants.CLICK_EVENT + Constants.EVENT_NS).on(Constants.CLICK_EVENT + Constants.EVENT_NS, e => {\r\n                    this.options.customButtons[btnKey].click.apply(this, [\r\n                        this,\r\n                        e\r\n                    ]);\r\n                });\r\n            }\r\n        }\r\n        _triggerHook(e, data) {\r\n            if (this.options.callbacks[e]) {\r\n                this.options.callbacks[e].apply(this, $.isArray(data) ? data : [data]);\r\n            }\r\n        }\r\n    }\r\n    //$.extend(PhotoViewer.prototype, draggable, movable, resizable);\r\n\r\n    ///$.extend(PhotoViewer.prototype, movable);\r\n\r\n    window.PhotoViewer = PhotoViewer;\r\n    return PhotoViewer;\r\n});\ndefine('skylark-photoviewer/main',[\r\n\t'./core'\r\n], function (PhotoViewer) {\r\n    'use strict';\r\n    return PhotoViewer;\r\n});\ndefine('skylark-photoviewer', ['skylark-photoviewer/main'], function (main) { return main; });\n\n"]}